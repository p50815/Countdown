<!DOCTYPE html>
<html style="height: 100%; margin: 0px; background-color: black;">

<head>
    <meta charset="utf-8">
    <script src="https://unpkg.com/vue@next"></script>
    <style>
        .countdownDiv {
            text-align: center;
            display: flex;
            align-items: center; 
 
            /* height: 33.3%; */
            height: 33.3%;
        }
        .countdownDivContent {
            /* height: 90%; */
            width: 100%;
            /* background-color: red; */
            /* display: flex;
            align-items: center; */
            font-size: 5vw;
            text-align: center;
            color: white;
        }
    </style>
</head>

<body style="height: 100%; margin: 0px;">
    <div id="basic-event" style="height: 100%; margin: 0px;">
        <div v-for="item in list" class="countdownDiv">
            <div class="countdownDivContent">取餐編號: {{ item.number }}&nbsp;&nbsp;&nbsp;&nbsp;{{
                this.getTimeLeft(item.createTime, item.countdownTime) }}</div>
        </div>
    </div>

    <script type="text/javascript">
        Vue.createApp({
            data() {
                return {
                    timer: 0,
                    list: []
                }
            },
            methods: {
                getCountdownList() {
                    let text = localStorage.getItem('countdownList')
                    if (text == null) text = '[]'
                    this.list = JSON.parse(text)
                },
                getTimeLeft(createTime, countdownTime) {
                    let t = (createTime + countdownTime * 1000 * 60) - new Date().getTime()
                    let allSec = parseInt(t / 1000)
                    let flag = '剩餘時間'
                    if (allSec < 0) flag = '逾時'

                    allSec = Math.abs(allSec)
                    let min = parseInt(allSec / 60)
                    let sec = allSec % 60
                    return `${flag}： ${min} 分 ${sec} 秒`
                }
            },
            mounted() {
                this.getCountdownList()
            },
            created() {
                this.timer = setInterval(() => {
                    this.getCountdownList()
                }, 1000)
            },
            beforeDestroy() {
                clearInterval(this.timer)
            }
        }).mount('#basic-event')
    </script>
</body>

</html>